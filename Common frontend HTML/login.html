<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Login - CareConnect</title>
  <link rel="stylesheet" href="/Common frontend CSS/login.css">
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar">
    <div class="logo">CareConnect</div>
    <ul class="nav-links">
      <li><a href="index.html">Home</a></li>
      <li><a href="about.html">About</a></li>
      <li><a href="donate.html">Donate</a></li>
      <li><a href="volunteer.html">Volunteer</a></li>
      <li><a href="ngo.html">NGO</a></li>
      <li><a href="login.html" class="active">Login</a></li>
      <li><a href="signup.html">Sign Up</a></li>
    </ul>
    <div class="menu-toggle">
      <span></span>
      <span></span>
      <span></span>
    </div>
  </nav>

  <!-- Main Content -->
  <div class="main-content">
    <div class="form-header">
      <h1>Welcome Back</h1>
      <p>Login to access your dashboard and continue making a difference</p>
    </div>
    
    <div class="form-container">
      <!-- User Type Selection -->
      <div class="user-type-tabs">
        <button type="button" class="tab-btn active" data-type="donor">Donor</button>
        <button type="button" class="tab-btn" data-type="volunteer">Volunteer</button>
        <button type="button" class="tab-btn" data-type="ngo">NGO</button>
      </div>

      <!-- Message Display -->
      <div id="message" class="message hidden"></div>
      
      <form id="loginForm">
        <div class="form-group">
          <label for="mobile">Mobile Number</label>
          <input type="tel" id="mobile" name="mobile" placeholder="Enter your 10-digit mobile number" 
                 pattern="[6-9][0-9]{9}" maxlength="10" required>
          <div class="error-message" id="mobile-error"></div>
        </div>
        
        <div class="form-group">
          <label for="password">Password</label>
          <input type="password" id="password" name="password" placeholder="Enter your password" 
                 minlength="6" required>
          <div class="error-message" id="password-error"></div>
        </div>
        
        <button type="submit" class="btn btn-primary">Login</button>
      </form>
  
      <div class="form-links">
        <a href="#">Forgot Password?</a>
        <a href="signup.html">Don't have an account? Sign up here</a>
      </div>
    </div>
    
    <!-- Benefits Section -->
    <div class="benefits-section">
      <div class="benefit-content" id="donor-benefits">
        <h2>Donor Benefits</h2>
        <div class="benefits-grid">
          <div class="benefit-card">
            <div class="benefit-icon">üìä</div>
            <h3>Track Impact</h3>
            <p>Monitor how your donations are making a difference in real-time.</p>
          </div>
          <div class="benefit-card">
            <div class="benefit-icon">üèÜ</div>
            <h3>Recognition</h3>
            <p>Get recognized for your contributions and charitable activities.</p>
          </div>
          <div class="benefit-card">
            <div class="benefit-icon">ü§ù</div>
            <h3>Connect</h3>
            <p>Connect with verified NGOs and trusted organizations.</p>
          </div>
          <div class="benefit-card">
            <div class="benefit-icon">üíù</div>
            <h3>Easy Giving</h3>
            <p>Simple, secure, and transparent donation process.</p>
          </div>
        </div>
      </div>

      <div class="benefit-content hidden" id="volunteer-benefits">
        <h2>Volunteer Benefits</h2>
        <div class="benefits-grid">
          <div class="benefit-card">
            <div class="benefit-icon">üéñÔ∏è</div>
            <h3>Certificates</h3>
            <p>Receive certificates and records of your volunteer service.</p>
          </div>
          <div class="benefit-card">
            <div class="benefit-icon">üë•</div>
            <h3>Community</h3>
            <p>Join a network of like-minded individuals making a difference.</p>
          </div>
          <div class="benefit-card">
            <div class="benefit-icon">üìö</div>
            <h3>Training</h3>
            <p>Access to free training sessions and skill development workshops.</p>
          </div>
          <div class="benefit-card">
            <div class="benefit-icon">‚≠ê</div>
            <h3>Points System</h3>
            <p>Earn reward points for every hour volunteered.</p>
          </div>
        </div>
      </div>

      <div class="benefit-content hidden" id="ngo-benefits">
        <h2>NGO Benefits</h2>
        <div class="benefits-grid">
          <div class="benefit-card">
            <div class="benefit-icon">üìà</div>
            <h3>Reach More</h3>
            <p>Expand your reach and connect with more donors and volunteers.</p>
          </div>
          <div class="benefit-card">
            <div class="benefit-icon">üíº</div>
            <h3>Manage</h3>
            <p>Efficiently manage campaigns, donations, and volunteer activities.</p>
          </div>
          <div class="benefit-card">
            <div class="benefit-icon">üìä</div>
            <h3>Analytics</h3>
            <p>Track your organization's impact with detailed analytics.</p>
          </div>
          <div class="benefit-card">
            <div class="benefit-icon">üîí</div>
            <h3>Verified</h3>
            <p>Get verified status to build trust with donors and volunteers.</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <p>&copy; 2024 CareConnect. All rights reserved.</p>
      <div class="social">
        <a href="#">Privacy Policy</a>
        <a href="#">Terms of Service</a>
        <a href="#">Contact Us</a>
      </div>
    </div>
  </footer>

  <script>
    // Enhanced universal login functionality
    document.addEventListener('DOMContentLoaded', function() {
        let currentUserType = 'donor';
        
        const tabButtons = document.querySelectorAll('.tab-btn');
        const loginForm = document.getElementById('loginForm');
        const messageDiv = document.getElementById('message');
        const benefitContents = document.querySelectorAll('.benefit-content');

        // Handle user type tabs
        tabButtons.forEach(btn => {
            btn.addEventListener('click', function() {
                const userType = this.dataset.type;
                switchUserType(userType);
            });
        });

        function switchUserType(type) {
            currentUserType = type;
            
            // Update active tab
            tabButtons.forEach(btn => btn.classList.remove('active'));
            document.querySelector(`[data-type="${type}"]`).classList.add('active');
            
            // Update benefits content
            benefitContents.forEach(content => content.classList.add('hidden'));
            document.getElementById(`${type}-benefits`).classList.remove('hidden');
        }

        // Handle form submission
        loginForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const mobile = document.getElementById('mobile').value.trim();
            const password = document.getElementById('password').value;

            if (!validateLogin(mobile, password)) {
                return;
            }

            performLogin(mobile, password, currentUserType);
        });

        function validateLogin(mobile, password) {
            clearMessages();

            const mobileRegex = /^[6-9]\d{9}$/;
            if (!mobile) {
                showError('Mobile number is required');
                return false;
            }
            if (!mobileRegex.test(mobile)) {
                showError('Please enter a valid 10-digit mobile number');
                return false;
            }

            if (!password) {
                showError('Password is required');
                return false;
            }
            if (password.length < 6) {
                showError('Password must be at least 6 characters long');
                return false;
            }

            return true;
        }

        function performLogin(mobile, password, userType) {
            setLoadingState(true);

            setTimeout(() => {
                try {
                    const users = JSON.parse(localStorage.getItem('registeredUsers') || '[]');
                    
                    // Find user based on type
                    let user;
                    if (userType === 'donor') {
                        user = users.find(u => u.mobile === mobile && u.userType === 'donor');
                    } else if (userType === 'volunteer') {
                        user = users.find(u => u.mobile === mobile && (u.userType === 'volunteer' || u.is_volunteer));
                    } else if (userType === 'ngo') {
                        user = users.find(u => u.mobile === mobile && (u.userType === 'ngo' || u.is_ngo));
                    }
                    
                    if (!user) {
                        setLoadingState(false);
                        showError(`Mobile number not registered as ${userType} or user not found.`);
                        return;
                    }

                    if (user.password !== password) {
                        setLoadingState(false);
                        showError('Invalid password. Please try again.');
                        return;
                    }

                    // Login successful
                    user.last_login = new Date().toISOString();
                    const userIndex = users.findIndex(u => u.mobile === mobile);
                    users[userIndex] = user;
                    localStorage.setItem('registeredUsers', JSON.stringify(users));
                    
                    // Create session
                    const userSession = {
                        user_id: user.user_id,
                        name: user.name,
                        email: user.email,
                        mobile: user.mobile,
                        address: user.address,
                        userType: userType,
                        loginTime: new Date().toISOString(),
                        sessionId: 'SESSION_' + Date.now()
                    };
                    
                    // Add type-specific fields
                    if (userType === 'volunteer') {
                        userSession.skills = user.skills || '';
                        userSession.availability = user.availability || '';
                    } else if (userType === 'ngo') {
                        userSession.registration = user.registration || '';
                        userSession.focus = user.focus || '';
                    }
                    
                    localStorage.setItem('currentUser', JSON.stringify(userSession));
                    
                    setLoadingState(false);
                    showSuccess(`Welcome back! Redirecting to your ${userType} dashboard...`);
                    
                    // Redirect based on user type
                    setTimeout(() => {
                        if (userType === 'donor') {
                            window.location.href = 'donor-dashboard.html';
                        } else if (userType === 'volunteer') {
                            window.location.href = 'volunteer-dashboard.html';
                        } else if (userType === 'ngo') {
                            window.location.href = 'ngo-dashboard.html';
                        }
                    }, 2000);
                    
                } catch (error) {
                    console.error('Login error:', error);
                    setLoadingState(false);
                    showError('Login failed. Please try again.');
                }
            }, 1000);
        }

        function clearMessages() {
            if (messageDiv) {
                messageDiv.className = 'message hidden';
                messageDiv.innerHTML = '';
            }
        }

        function showError(message) {
            if (messageDiv) {
                messageDiv.className = 'message error';
                messageDiv.innerHTML = message;
                messageDiv.classList.remove('hidden');
            }
        }

        function showSuccess(message) {
            if (messageDiv) {
                messageDiv.className = 'message success';
                messageDiv.innerHTML = message;
                messageDiv.classList.remove('hidden');
            }
        }

        function setLoadingState(loading) {
            const submitButton = loginForm.querySelector('button[type="submit"]');
            if (loading) {
                submitButton.disabled = true;
                submitButton.textContent = 'Logging in...';
            } else {
                submitButton.disabled = false;
                submitButton.textContent = 'Login';
            }
        }

        // Mobile number formatting
        const mobileInput = document.getElementById('mobile');
        mobileInput.addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length > 10) {
                value = value.slice(0, 10);
            }
            e.target.value = value;
        });
    });
  </script>
</body>
</html>